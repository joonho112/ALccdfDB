<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Cross-Module Linkage and Database Integration • ALccdfDB</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Cross-Module Linkage and Database Integration">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">ALccdfDB</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item"><a class="nav-link" href="../articles/index.html">Articles</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/joonho112/ALccdfDB" aria-label="GitHub"><span class="fa fa-github"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Cross-Module Linkage and Database Integration</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/joonho112/ALccdfDB/blob/HEAD/vignettes/data-linkage.Rmd" class="external-link"><code>vignettes/data-linkage.Rmd</code></a></small>
      <div class="d-none name"><code>data-linkage.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="overview">Overview<a class="anchor" aria-label="anchor" href="#overview"></a>
</h2>
<p>ALccdfDB links four administrative data modules into enriched,
analysis-ready datasets. The linkage layer connects programs to enrolled
children (by <code>facility_id</code>), to subsidy clients (by
<code>provider_id</code>), and to Alabama Pathways staff records (by
<code>facility_name</code>, case-insensitive). A reverse linkage also
appends program attributes onto individual client rows for spatial
analysis.</p>
<p>Four linkage types are available:</p>
<ul>
<li>
<strong>Programs x Enrolled</strong> – aggregate enrollment counts
onto programs</li>
<li>
<strong>Programs x Clients</strong> – aggregate client counts and
copay onto programs</li>
<li>
<strong>Programs x Staff</strong> – aggregate staff counts and
career levels onto programs</li>
<li>
<strong>Clients x Programs</strong> – append program attributes onto
client rows</li>
</ul>
<p>This vignette also demonstrates Melissa geocoding output and DuckDB
integration for persistent storage and SQL-based querying.</p>
</div>
<div class="section level2">
<h2 id="setup-and-data-generation">Setup and Data Generation<a class="anchor" aria-label="anchor" href="#setup-and-data-generation"></a>
</h2>
<p>All synthetic generators share a common facility pool when called
with the same seed, ensuring that <code>facility_id</code>,
<code>provider_id</code>, and <code>facility_name</code> overlap across
modules to enable linkage.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://joonho112.github.io/ALccdfDB/">ALccdfDB</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: package 'dplyr' was built under R version 4.5.2</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'dplyr'</span></span>
<span><span class="co">#&gt; The following object is masked from 'package:ALccdfDB':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     db_list_tables</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:stats':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     filter, lag</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:base':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     intersect, setdiff, setequal, union</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: package 'ggplot2' was built under R version 4.5.2</span></span>
<span></span>
<span><span class="va">seed</span> <span class="op">&lt;-</span> <span class="fl">42</span></span>
<span><span class="va">programs</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/synthetic-data.html">alccdf_synthetic_programs</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">50</span>, seed <span class="op">=</span> <span class="va">seed</span><span class="op">)</span></span>
<span><span class="va">subsidy</span>  <span class="op">&lt;-</span> <span class="fu"><a href="../reference/synthetic-data.html">alccdf_synthetic_subsidy</a></span><span class="op">(</span>n_enrolled <span class="op">=</span> <span class="fl">80</span>, n_clients <span class="op">=</span> <span class="fl">40</span>, seed <span class="op">=</span> <span class="va">seed</span><span class="op">)</span></span>
<span><span class="va">staff</span>    <span class="op">&lt;-</span> <span class="fu"><a href="../reference/synthetic-data.html">alccdf_synthetic_staff</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">60</span>, seed <span class="op">=</span> <span class="va">seed</span><span class="op">)</span></span>
<span><span class="va">melissa</span>  <span class="op">&lt;-</span> <span class="fu"><a href="../reference/synthetic-data.html">alccdf_synthetic_melissa</a></span><span class="op">(</span>programs <span class="op">=</span> <span class="va">programs</span>, seed <span class="op">=</span> <span class="va">seed</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="verify-shared-keys">Verify Shared Keys<a class="anchor" aria-label="anchor" href="#verify-shared-keys"></a>
</h2>
<p>Before running linkage, verify that the shared join keys overlap
across modules.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">prg_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/alccdf_data.html">alccdf_data</a></span><span class="op">(</span><span class="va">programs</span><span class="op">)</span></span>
<span><span class="va">enr_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/alccdf_data.html">alccdf_data</a></span><span class="op">(</span><span class="va">subsidy</span><span class="op">$</span><span class="va">enrolled</span><span class="op">)</span></span>
<span><span class="va">cli_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/alccdf_data.html">alccdf_data</a></span><span class="op">(</span><span class="va">subsidy</span><span class="op">$</span><span class="va">clients</span><span class="op">)</span></span>
<span><span class="va">stf_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/alccdf_data.html">alccdf_data</a></span><span class="op">(</span><span class="va">staff</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># facility_id overlap (programs &lt;-&gt; enrolled)</span></span>
<span><span class="va">prg_fids</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">prg_data</span><span class="op">$</span><span class="va">facility_id</span><span class="op">)</span></span>
<span><span class="va">enr_fids</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">enr_data</span><span class="op">$</span><span class="va">facility_id</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Programs facility_ids:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">prg_fids</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Programs facility_ids: 50</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Enrolled facility_ids:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">enr_fids</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Enrolled facility_ids: 50</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Overlap (facility_id):"</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="fu"><a href="https://generics.r-lib.org/reference/setops.html" class="external-link">intersect</a></span><span class="op">(</span><span class="va">prg_fids</span>, <span class="va">enr_fids</span><span class="op">)</span><span class="op">)</span>, <span class="st">"\n\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Overlap (facility_id): 33</span></span>
<span></span>
<span><span class="co"># provider_id overlap (programs &lt;-&gt; clients)</span></span>
<span><span class="va">prg_pids</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">prg_data</span><span class="op">$</span><span class="va">provider_id</span><span class="op">)</span></span>
<span><span class="va">cli_pids</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">cli_data</span><span class="op">$</span><span class="va">provider_id</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Programs provider_ids:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">prg_pids</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Programs provider_ids: 50</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Clients provider_ids:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">cli_pids</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Clients provider_ids: 32</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Overlap (provider_id):"</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="fu"><a href="https://generics.r-lib.org/reference/setops.html" class="external-link">intersect</a></span><span class="op">(</span><span class="va">prg_pids</span>, <span class="va">cli_pids</span><span class="op">)</span><span class="op">)</span>, <span class="st">"\n\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Overlap (provider_id): 32</span></span>
<span></span>
<span><span class="co"># facility_name overlap (programs &lt;-&gt; staff, case-insensitive)</span></span>
<span><span class="va">prg_names</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/chartr.html" class="external-link">tolower</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/trimws.html" class="external-link">trimws</a></span><span class="op">(</span><span class="va">prg_data</span><span class="op">$</span><span class="va">facility_name</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">stf_names</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/chartr.html" class="external-link">tolower</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/trimws.html" class="external-link">trimws</a></span><span class="op">(</span><span class="va">stf_data</span><span class="op">$</span><span class="va">facility_name</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Programs facility_names:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">prg_names</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Programs facility_names: 50</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Staff facility_names:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">stf_names</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Staff facility_names: 37</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Overlap (facility_name):"</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="fu"><a href="https://generics.r-lib.org/reference/setops.html" class="external-link">intersect</a></span><span class="op">(</span><span class="va">prg_names</span>, <span class="va">stf_names</span><span class="op">)</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Overlap (facility_name): 28</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="programs-x-enrolled-children">Programs x Enrolled Children<a class="anchor" aria-label="anchor" href="#programs-x-enrolled-children"></a>
</h2>
<p>Link programs to enrolled children by <code>facility_id</code>. Each
program row is preserved (LEFT JOIN) and enriched with enrollment
aggregates: the number of enrolled children, case counts, and care level
distribution columns.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">linked_pe</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/linkage_programs_enrolled.html">linkage_programs_enrolled</a></span><span class="op">(</span><span class="va">programs</span>, <span class="va">subsidy</span><span class="op">$</span><span class="va">enrolled</span>, verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">linked_pe</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ── <span style="font-weight: bold;">ALccdfDB Linkage: Programs x Enrolled Children</span> ──</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Join key: facility_id</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Backbone: programs</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Dimensions: 50 rows x 57 cols</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Programs: 50</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Enrolled records: 80</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Match rate: 33/50 (66%)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ── Processing Log</span></span>
<span><span class="co">#&gt; [2026-02-15 15:55:55] Linked programs x enrolled: 33/50 programs matched (66%),</span></span>
<span><span class="co">#&gt; 80 enrolled records</span></span></code></pre></div>
<p>Inspect the new columns added by the linkage:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pe_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/alccdf_data.html">alccdf_data</a></span><span class="op">(</span><span class="va">linked_pe</span><span class="op">)</span></span>
<span><span class="va">new_cols</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"n_enrolled_children"</span>, <span class="st">"n_cases"</span>,</span>
<span>              <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grep</a></span><span class="op">(</span><span class="st">"^care_level_"</span>, <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">pe_df</span><span class="op">)</span>, value <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">pe_df</span><span class="op">[</span>, <span class="fu"><a href="https://generics.r-lib.org/reference/setops.html" class="external-link">intersect</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"facility_id"</span>, <span class="st">"facility_name"</span>, <span class="va">new_cols</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">pe_df</span><span class="op">)</span><span class="op">)</span><span class="op">]</span>, <span class="fl">10</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 10 × 8</span></span></span>
<span><span class="co">#&gt;    facility_id facility_name  n_enrolled_children n_cases care_level_School Ag…¹</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                        <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>                  <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> FX001       JSU Child Lea…                   0       0                     <span style="color: #BB0000;">NA</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> FX002       Gadsden State…                   1       1                      1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> FC001       Jubilee Child…                   1       1                      1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> FG001       Lakeside Grou…                   2       2                      1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> FE001       New Hope Chur…                   1       1                      0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> FE002       Emmanuel Luth…                   0       0                     <span style="color: #BB0000;">NA</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> FF001       Hall Family D…                   0       0                     <span style="color: #BB0000;">NA</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> FC002       Happy Hearts …                   0       0                     <span style="color: #BB0000;">NA</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> FF002       Walker Home C…                   2       2                      1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> FF003       Smith Family …                   1       1                      1</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ abbreviated name: ¹​`care_level_School Age`</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 3 more variables: care_level_PreSchool &lt;int&gt;, care_level_Toddler &lt;int&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   care_level_Infant &lt;int&gt;</span></span></span></code></pre></div>
<p><strong>Figure 1: Distribution of Enrolled Children per
Program</strong></p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pe_plot</span> <span class="op">&lt;-</span> <span class="va">pe_df</span><span class="op">[</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">pe_df</span><span class="op">$</span><span class="va">n_enrolled_children</span><span class="op">)</span>, <span class="op">]</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">pe_plot</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">n_enrolled_children</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html" class="external-link">geom_histogram</a></span><span class="op">(</span>binwidth <span class="op">=</span> <span class="fl">1</span>, fill <span class="op">=</span> <span class="st">"#4292C6"</span>, color <span class="op">=</span> <span class="st">"white"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Enrolled Children per Program"</span>,</span>
<span>    x <span class="op">=</span> <span class="st">"Number of Enrolled Children"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Count of Programs"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="data-linkage_files/figure-html/fig-enrolled-hist-1.png" class="r-plt" alt="Distribution of enrolled children per program" width="672"><p class="caption">
Distribution of enrolled children per program
</p>
</div>
<p><strong>Figure 2: Enrolled Children by Facility Type</strong></p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">pe_plot</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">facility_type</span>, y <span class="op">=</span> <span class="va">n_enrolled_children</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html" class="external-link">geom_boxplot</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"#9ECAE1"</span>, outlier.color <span class="op">=</span> <span class="st">"#084594"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Enrolled Children by Facility Type"</span>,</span>
<span>    x <span class="op">=</span> <span class="st">"Facility Type"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Number of Enrolled Children"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>axis.text.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">30</span>, hjust <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="data-linkage_files/figure-html/fig-enrolled-boxplot-1.png" class="r-plt" alt="Enrolled children by facility type" width="672"><p class="caption">
Enrolled children by facility type
</p>
</div>
</div>
<div class="section level2">
<h2 id="programs-x-clients">Programs x Clients<a class="anchor" aria-label="anchor" href="#programs-x-clients"></a>
</h2>
<p>Link programs to subsidy clients (Active Clients With Addresses) by
<code>provider_id</code>. Aggregated columns include
<code>n_active_clients</code>, <code>avg_copay_weekly</code>, and
<code>n_unique_cases</code>.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">linked_pc</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/linkage_programs_clients.html">linkage_programs_clients</a></span><span class="op">(</span><span class="va">programs</span>, <span class="va">subsidy</span><span class="op">$</span><span class="va">clients</span>, verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">linked_pc</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ── <span style="font-weight: bold;">ALccdfDB Linkage: Programs x Subsidy Clients</span> ──</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Join key: provider_id</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Backbone: programs</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Dimensions: 50 rows x 54 cols</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Programs: 50</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Client records: 40</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Match rate: 32/50 (64%)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ── Processing Log</span></span>
<span><span class="co">#&gt; [2026-02-15 15:55:56] Linked programs x clients: 32/50 programs matched (64%),</span></span>
<span><span class="co">#&gt; 40 client records</span></span></code></pre></div>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pc_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/alccdf_data.html">alccdf_data</a></span><span class="op">(</span><span class="va">linked_pc</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">pc_df</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"facility_id"</span>, <span class="st">"facility_name"</span>, <span class="st">"n_active_clients"</span>,</span>
<span>               <span class="st">"avg_copay_weekly"</span>, <span class="st">"n_unique_cases"</span><span class="op">)</span><span class="op">]</span>, <span class="fl">10</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 10 × 5</span></span></span>
<span><span class="co">#&gt;    facility_id facility_name    n_active_clients avg_copay_weekly n_unique_cases</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                       <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>            <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> FX001       JSU Child Learn…                3            35.8               3</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> FX002       Gadsden State C…                0            <span style="color: #BB0000;">NA</span>                 0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> FC001       Jubilee Child C…                2            15.2               2</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> FG001       Lakeside Group …                1            31.2               1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> FE001       New Hope Church…                1            45.4               1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> FE002       Emmanuel Luther…                1             8.72              1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> FF001       Hall Family Day…                0            <span style="color: #BB0000;">NA</span>                 0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> FC002       Happy Hearts Ch…                1             6.19              1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> FF002       Walker Home Chi…                1             9.57              1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> FF003       Smith Family Ch…                0            <span style="color: #BB0000;">NA</span>                 0</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="programs-x-staff">Programs x Staff<a class="anchor" aria-label="anchor" href="#programs-x-staff"></a>
</h2>
<p>Link programs to Alabama Pathways staff data by
<code>facility_name</code> (case-insensitive, whitespace-trimmed). Adds
<code>n_staff</code> and career lattice level distribution columns.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">linked_ps</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/linkage_programs_staff.html">linkage_programs_staff</a></span><span class="op">(</span><span class="va">programs</span>, <span class="va">staff</span>, verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">linked_ps</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ── <span style="font-weight: bold;">ALccdfDB Linkage: Programs x Staff</span> ──</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Join key: facility_name (case-insensitive, trimmed)</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Backbone: programs</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Dimensions: 50 rows x 57 cols</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Programs: 50</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Staff records: 60</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Match rate: 28/50 (56%)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ── Processing Log</span></span>
<span><span class="co">#&gt; [2026-02-15 15:55:56] Linked programs x staff: 28/50 programs matched (56%), 60</span></span>
<span><span class="co">#&gt; staff records</span></span></code></pre></div>
<p><strong>Figure 3: Mean Staff per Program by Facility
Type</strong></p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ps_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/alccdf_data.html">alccdf_data</a></span><span class="op">(</span><span class="va">linked_ps</span><span class="op">)</span></span>
<span></span>
<span><span class="va">staff_summary</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/aggregate.html" class="external-link">aggregate</a></span><span class="op">(</span><span class="va">n_staff</span> <span class="op">~</span> <span class="va">facility_type</span>, data <span class="op">=</span> <span class="va">ps_df</span>, FUN <span class="op">=</span> <span class="va">mean</span><span class="op">)</span></span>
<span><span class="va">staff_summary</span><span class="op">$</span><span class="va">n_staff</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">staff_summary</span><span class="op">$</span><span class="va">n_staff</span>, <span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">staff_summary</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/reorder.factor.html" class="external-link">reorder</a></span><span class="op">(</span><span class="va">facility_type</span>, <span class="va">n_staff</span><span class="op">)</span>, y <span class="op">=</span> <span class="va">n_staff</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html" class="external-link">geom_col</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"#74C476"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html" class="external-link">geom_text</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>label <span class="op">=</span> <span class="va">n_staff</span><span class="op">)</span>, hjust <span class="op">=</span> <span class="op">-</span><span class="fl">0.2</span>, size <span class="op">=</span> <span class="fl">3.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_flip.html" class="external-link">coord_flip</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Mean Staff per Program by Facility Type"</span>,</span>
<span>    x <span class="op">=</span> <span class="st">"Facility Type"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Mean Number of Staff"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="data-linkage_files/figure-html/fig-staff-bar-1.png" class="r-plt" alt="Mean staff count per program by facility type" width="672"><p class="caption">
Mean staff count per program by facility type
</p>
</div>
</div>
<div class="section level2">
<h2 id="clients-x-programs">Clients x Programs<a class="anchor" aria-label="anchor" href="#clients-x-programs"></a>
</h2>
<p>The reverse linkage appends program-level attributes (facility type,
tier, coordinates, capacity, etc.) onto individual client rows. This is
useful for spatial analysis comparing household and program
locations.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">linked_cp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/linkage_clients_programs.html">linkage_clients_programs</a></span><span class="op">(</span><span class="va">subsidy</span><span class="op">$</span><span class="va">clients</span>, <span class="va">programs</span>, verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">linked_cp</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ── <span style="font-weight: bold;">ALccdfDB Linkage: Clients x Programs</span> ──</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Join key: provider_id</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Backbone: clients</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Dimensions: 40 rows x 33 cols</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Clients: 40</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Programs: 50</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Match rate: 40/40 (100%)</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Program columns appended: facility_id, facility_name, facility_type, facility_tier, facility_address, county, region, day_capacity, night_capacity, day_age_range, night_age_range, day_start, day_end, night_start, night_end, expiration_date, days_till_expire, license_number, snapshot_date</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ── Processing Log</span></span>
<span><span class="co">#&gt; [2026-02-15 15:55:56] Linked clients x programs: 40/40 client rows matched</span></span>
<span><span class="co">#&gt; (100%), 19 program columns appended</span></span></code></pre></div>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cp_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/alccdf_data.html">alccdf_data</a></span><span class="op">(</span><span class="va">linked_cp</span><span class="op">)</span></span>
<span><span class="va">prog_cols</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://generics.r-lib.org/reference/setops.html" class="external-link">intersect</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"provider_id"</span>, <span class="st">"family_address"</span>, <span class="st">"facility_name"</span>, <span class="st">"facility_type"</span>, <span class="st">"county"</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">cp_df</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">cp_df</span><span class="op">[</span>, <span class="va">prog_cols</span><span class="op">]</span>, <span class="fl">8</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 8 × 5</span></span></span>
<span><span class="co">#&gt;   provider_id family_address                  facility_name facility_type county</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                           <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> P0004       2442 Cypress Circle, Florence,… Lakeside Gro… Group Home    Calho…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> P0001       2997 Walnut Avenue, Alabaster,… JSU Child Le… Excepted (Un… St. C…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> P0020       842 Oak Lane, Alabaster, AL 35… Pleasant Hil… Faith-Based   Dale  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> P0048       8066 Elm Street, Florence, AL … Grace Commun… Faith-Based   Houst…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> P0044       1669 Pecan Drive, Mobile, AL 3… Calhoun Comm… Excepted (Un… St. C…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> P0042       6738 Pine Way, Mobile, AL 36602 Dogwood Lear… Center        Montg…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">7</span> P0038       523 Cypress Circle, Huntsville… ABC Learning… Center        St. C…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">8</span> P0023       6690 Birch Road, Dothan, AL 36… Auburn Unive… Excepted (Un… St. C…</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="linkage-diagnostics-summary">Linkage Diagnostics Summary<a class="anchor" aria-label="anchor" href="#linkage-diagnostics-summary"></a>
</h2>
<p>Compare match rates across all four linkage types. The summary is
built manually since the metadata structure differs between linkage
types.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">diag_summary</span> <span class="op">&lt;-</span> <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span></span>
<span>  Linkage <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>    <span class="st">"Programs x Enrolled"</span>,</span>
<span>    <span class="st">"Programs x Clients"</span>,</span>
<span>    <span class="st">"Programs x Staff"</span>,</span>
<span>    <span class="st">"Clients x Programs"</span></span>
<span>  <span class="op">)</span>,</span>
<span>  Join_Key <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>    <span class="st">"facility_id"</span>,</span>
<span>    <span class="st">"provider_id"</span>,</span>
<span>    <span class="st">"facility_name"</span>,</span>
<span>    <span class="st">"provider_id"</span></span>
<span>  <span class="op">)</span>,</span>
<span>  n_matched <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>    <span class="va">linked_pe</span><span class="op">$</span><span class="va">meta</span><span class="op">$</span><span class="va">n_matched</span>,</span>
<span>    <span class="va">linked_pc</span><span class="op">$</span><span class="va">meta</span><span class="op">$</span><span class="va">n_matched</span>,</span>
<span>    <span class="va">linked_ps</span><span class="op">$</span><span class="va">meta</span><span class="op">$</span><span class="va">n_matched</span>,</span>
<span>    <span class="va">linked_cp</span><span class="op">$</span><span class="va">meta</span><span class="op">$</span><span class="va">n_matched</span></span>
<span>  <span class="op">)</span>,</span>
<span>  n_total <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>    <span class="va">linked_pe</span><span class="op">$</span><span class="va">meta</span><span class="op">$</span><span class="va">n_programs</span>,</span>
<span>    <span class="va">linked_pc</span><span class="op">$</span><span class="va">meta</span><span class="op">$</span><span class="va">n_programs</span>,</span>
<span>    <span class="va">linked_ps</span><span class="op">$</span><span class="va">meta</span><span class="op">$</span><span class="va">n_programs</span>,</span>
<span>    <span class="va">linked_cp</span><span class="op">$</span><span class="va">meta</span><span class="op">$</span><span class="va">n_linked</span></span>
<span>  <span class="op">)</span>,</span>
<span>  match_rate_pct <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>    <span class="va">linked_pe</span><span class="op">$</span><span class="va">meta</span><span class="op">$</span><span class="va">match_rate</span>,</span>
<span>    <span class="va">linked_pc</span><span class="op">$</span><span class="va">meta</span><span class="op">$</span><span class="va">match_rate</span>,</span>
<span>    <span class="va">linked_ps</span><span class="op">$</span><span class="va">meta</span><span class="op">$</span><span class="va">match_rate</span>,</span>
<span>    <span class="va">linked_cp</span><span class="op">$</span><span class="va">meta</span><span class="op">$</span><span class="va">match_rate</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">diag_summary</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 4 × 5</span></span></span>
<span><span class="co">#&gt;   Linkage             Join_Key      n_matched n_total match_rate_pct</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>               <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>             <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> Programs x Enrolled facility_id          33      50             66</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> Programs x Clients  provider_id          32      50             64</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> Programs x Staff    facility_name        28      50             56</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> Clients x Programs  provider_id          40      40            100</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="melissa-geocoding">Melissa Geocoding<a class="anchor" aria-label="anchor" href="#melissa-geocoding"></a>
</h2>
<p>The Melissa geocoding module provides latitude, longitude, census
tract, FIPS code, and address standardization for both program and
household addresses. The synthetic generator produces realistic Alabama
coordinates within the state bounding box.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">melissa</span><span class="op">$</span><span class="va">programs</span>, <span class="fl">8</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 8 × 15</span></span></span>
<span><span class="co">#&gt;   facility_address        latitude longitude census_tract census_block fips_code</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> 4991 MCFARLAND BOULEVA…     31.7     -<span style="color: #BB0000;">85.7</span>       <span style="text-decoration: underline;">816</span>614         <span style="text-decoration: underline;">9</span>727      <span style="text-decoration: underline;">1</span>097</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> 6873 MCFARLAND BOULEVA…     30.3     -<span style="color: #BB0000;">86.4</span>       <span style="text-decoration: underline;">574</span>227         <span style="text-decoration: underline;">2</span>495      <span style="text-decoration: underline;">1</span>069</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> 3208 HIGHLAND AVENUE, …     31.9     -<span style="color: #BB0000;">85.4</span>       <span style="text-decoration: underline;">767</span>203         <span style="text-decoration: underline;">4</span>334      <span style="text-decoration: underline;">1</span>103</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> 9453 QUINTARD AVENUE, …     31.9     -<span style="color: #BB0000;">86.3</span>       <span style="text-decoration: underline;">691</span>108         <span style="text-decoration: underline;">2</span>268      <span style="text-decoration: underline;">1</span>081</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> 2920 HIGHLAND AVENUE, …     32.1     -<span style="color: #BB0000;">85.5</span>       <span style="text-decoration: underline;">859</span>017         <span style="text-decoration: underline;">1</span>865      <span style="text-decoration: underline;">1</span>073</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> 4273 MEMORIAL PARKWAY,…     32.6     -<span style="color: #BB0000;">87.9</span>       <span style="text-decoration: underline;">621</span>691         <span style="text-decoration: underline;">4</span>348      <span style="text-decoration: underline;">1</span>003</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">7</span> 4721 DEXTER AVENUE, AL…     34.3     -<span style="color: #BB0000;">84.9</span>       <span style="text-decoration: underline;">777</span>938         <span style="text-decoration: underline;">1</span>043      <span style="text-decoration: underline;">1</span>055</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">8</span> 3839 FAIRVIEW AVENUE, …     30.4     -<span style="color: #BB0000;">85.4</span>       <span style="text-decoration: underline;">667</span>786         <span style="text-decoration: underline;">6</span>534      <span style="text-decoration: underline;">1</span>003</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 9 more variables: melissa_county &lt;chr&gt;, melissa_place &lt;chr&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   melissa_place_code &lt;int&gt;, melissa_city &lt;chr&gt;, melissa_state &lt;chr&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   melissa_zip &lt;chr&gt;, melissa_geo_zip &lt;chr&gt;, melissa_result_code &lt;chr&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   melissa_status_code &lt;chr&gt;</span></span></span></code></pre></div>
<p><strong>Figure 4: Geocoded Program Locations</strong></p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">melissa</span><span class="op">$</span><span class="va">programs</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">longitude</span>, y <span class="op">=</span> <span class="va">latitude</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"#E6550D"</span>, alpha <span class="op">=</span> <span class="fl">0.7</span>, size <span class="op">=</span> <span class="fl">2.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Geocoded Program Locations"</span>,</span>
<span>    subtitle <span class="op">=</span> <span class="st">"Synthetic Melissa output for Alabama CCDF programs"</span>,</span>
<span>    x <span class="op">=</span> <span class="st">"Longitude"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Latitude"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="data-linkage_files/figure-html/fig-melissa-scatter-1.png" class="r-plt" alt="Scatter plot of geocoded program locations across Alabama" width="672"><p class="caption">
Scatter plot of geocoded program locations across Alabama
</p>
</div>
</div>
<div class="section level2">
<h2 id="duckdb-integration">DuckDB Integration<a class="anchor" aria-label="anchor" href="#duckdb-integration"></a>
</h2>
<p>Store processed data in a DuckDB database for efficient querying and
persistent snapshots. The database module supports writing any S3 object
via <code><a href="../reference/db_write_snapshot.html">db_write_snapshot()</a></code> and querying with standard SQL.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">db_path</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempfile</a></span><span class="op">(</span>fileext <span class="op">=</span> <span class="st">".duckdb"</span><span class="op">)</span></span>
<span><span class="va">conn</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/db_init.html">db_init</a></span><span class="op">(</span><span class="va">db_path</span>, verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Write program, enrolled, and staff snapshots</span></span>
<span><span class="fu"><a href="../reference/db_write_snapshot.html">db_write_snapshot</a></span><span class="op">(</span><span class="va">conn</span>, <span class="va">programs</span>, <span class="st">"programs"</span>, verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/db_write_snapshot.html">db_write_snapshot</a></span><span class="op">(</span><span class="va">conn</span>, <span class="va">subsidy</span><span class="op">$</span><span class="va">enrolled</span>, <span class="st">"enrolled"</span>, verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/db_write_snapshot.html">db_write_snapshot</a></span><span class="op">(</span><span class="va">conn</span>, <span class="va">staff</span>, <span class="st">"staff"</span>, verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">ALccdfDB</span><span class="fu">::</span><span class="fu"><a href="../reference/db_list_tables.html">db_list_tables</a></span><span class="op">(</span><span class="va">conn</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "enrolled" "programs" "staff"</span></span></code></pre></div>
<div class="section level3">
<h3 id="sql-queries">SQL Queries<a class="anchor" aria-label="anchor" href="#sql-queries"></a>
</h3>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Programs by county: count and average day capacity</span></span>
<span><span class="fu"><a href="../reference/db_query.html">db_query</a></span><span class="op">(</span><span class="va">conn</span>, <span class="st">"</span></span>
<span><span class="st">  SELECT county, COUNT(*) AS n_programs,</span></span>
<span><span class="st">         ROUND(AVG(day_capacity), 0) AS avg_day_capacity</span></span>
<span><span class="st">  FROM programs</span></span>
<span><span class="st">  GROUP BY county</span></span>
<span><span class="st">  ORDER BY n_programs DESC</span></span>
<span><span class="st">  LIMIT 10</span></span>
<span><span class="st">"</span>, verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 10 × 3</span></span></span>
<span><span class="co">#&gt;    county     n_programs avg_day_capacity</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>           <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>            <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> St. Clair           5               97</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> Morgan              4               43</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> Calhoun             4               48</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> Mobile              4               50</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> Tuscaloosa          3               68</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> DeKalb              3               36</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> Lauderdale          3              114</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> Jefferson           3               63</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> Lee                 3               34</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> Shelby              2                6</span></span></code></pre></div>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Enrollment by care level: count and distinct cases</span></span>
<span><span class="fu"><a href="../reference/db_query.html">db_query</a></span><span class="op">(</span><span class="va">conn</span>, <span class="st">"</span></span>
<span><span class="st">  SELECT care_level, COUNT(*) AS n_records,</span></span>
<span><span class="st">         COUNT(DISTINCT case_id) AS n_cases</span></span>
<span><span class="st">  FROM enrolled</span></span>
<span><span class="st">  GROUP BY care_level</span></span>
<span><span class="st">  ORDER BY n_records DESC</span></span>
<span><span class="st">"</span>, verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 4 × 3</span></span></span>
<span><span class="co">#&gt;   care_level n_records n_cases</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> School Age        46      46</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> Toddler           15      15</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> PreSchool         15      15</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> Infant             4       4</span></span></code></pre></div>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Column metadata for the programs table</span></span>
<span><span class="fu"><a href="../reference/db_table_info.html">db_table_info</a></span><span class="op">(</span><span class="va">conn</span>, <span class="st">"programs"</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 51 × 3</span></span></span>
<span><span class="co">#&gt;    column_name       column_type description</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>             <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> facility_id       VARCHAR     <span style="color: #BB0000;">NA</span>         </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> facility_name     VARCHAR     <span style="color: #BB0000;">NA</span>         </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> facility_type_raw VARCHAR     <span style="color: #BB0000;">NA</span>         </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> facility_type     VARCHAR     <span style="color: #BB0000;">NA</span>         </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> facility_tier     VARCHAR     <span style="color: #BB0000;">NA</span>         </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> county            VARCHAR     <span style="color: #BB0000;">NA</span>         </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> region            VARCHAR     <span style="color: #BB0000;">NA</span>         </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> facility_address  VARCHAR     <span style="color: #BB0000;">NA</span>         </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> facility_address2 VARCHAR     <span style="color: #BB0000;">NA</span>         </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> provider_id       VARCHAR     <span style="color: #BB0000;">NA</span>         </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 41 more rows</span></span></span></code></pre></div>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/db_close.html">db_close</a></span><span class="op">(</span><span class="va">conn</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Database connection closed</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/unlink.html" class="external-link">unlink</a></span><span class="op">(</span><span class="va">db_path</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="export">Export<a class="anchor" aria-label="anchor" href="#export"></a>
</h2>
<p>Export linked datasets to multiple formats for use in Stata, Excel,
or other tools:</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># CSV</span></span>
<span><span class="fu"><a href="../reference/linkage_programs_enrolled_export_csv.html">linkage_programs_enrolled_export_csv</a></span><span class="op">(</span><span class="va">linked_pe</span>, <span class="st">"output/linkage/programs_enrolled.csv"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Excel</span></span>
<span><span class="fu"><a href="../reference/linkage_programs_enrolled_export_excel.html">linkage_programs_enrolled_export_excel</a></span><span class="op">(</span><span class="va">linked_pe</span>, <span class="st">"output/linkage/programs_enrolled.xlsx"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Stata</span></span>
<span><span class="fu"><a href="../reference/linkage_programs_enrolled_export_stata.html">linkage_programs_enrolled_export_stata</a></span><span class="op">(</span><span class="va">linked_pe</span>, <span class="st">"output/linkage/programs_enrolled.dta"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># RDS (preserves S3 classes and factor levels)</span></span>
<span><span class="fu"><a href="../reference/linkage_programs_enrolled_export_rds.html">linkage_programs_enrolled_export_rds</a></span><span class="op">(</span><span class="va">linked_pe</span>, <span class="st">"output/linkage/programs_enrolled.rds"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># All formats at once</span></span>
<span><span class="fu"><a href="../reference/linkage_programs_enrolled_export_all.html">linkage_programs_enrolled_export_all</a></span><span class="op">(</span><span class="va">linked_pe</span>, <span class="st">"output/linkage/"</span>, <span class="st">"programs_enrolled"</span><span class="op">)</span></span></code></pre></div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://orcid.org/0009-0006-4019-8703" class="external-link">JoonHo Lee</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
