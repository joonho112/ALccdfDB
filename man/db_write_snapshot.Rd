% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/db-write.R
\name{db_write_snapshot}
\alias{db_write_snapshot}
\title{Write a data snapshot to DuckDB}
\usage{
db_write_snapshot(
  conn,
  obj,
  table_name,
  snapshot_date = NULL,
  is_current = FALSE,
  overwrite = FALSE,
  verbose = TRUE
)
}
\arguments{
\item{conn}{A DBI connection object from \code{\link{db_init}}.}

\item{obj}{An ALccdfDB S3 object (any module) or a data frame.}

\item{table_name}{Character. Name of the target DuckDB table.}

\item{snapshot_date}{Date. Snapshot date. If NULL, extracted from the object's
metadata or defaults to today.}

\item{is_current}{Logical. Mark this snapshot as the current (active) one?
Default FALSE.}

\item{overwrite}{Logical. If TRUE and the table already exists with data for
this snapshot_date, the old data is removed first. Default FALSE.}

\item{verbose}{Logical; print progress messages? Default TRUE.}
}
\value{
Invisible table name.
}
\description{
Extracts data from an ALccdfDB S3 object, adds a \code{snapshot_date} column
if not present, writes to a DuckDB table (append mode), and registers the
snapshot in the internal tracking table.
}
\examples{
\dontrun{
conn <- db_init("output/alccdfdb.duckdb")
db_write_snapshot(conn, program_clean, "programs",
                  snapshot_date = "2025-06-11", is_current = TRUE)
db_close(conn)
}

}
