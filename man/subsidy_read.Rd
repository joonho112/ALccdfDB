% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/subsidy-read.R
\name{subsidy_read}
\alias{subsidy_read}
\title{Read a single subsidy Excel file}
\usage{
subsidy_read(
  path,
  type,
  snapshot_date,
  sheet = NULL,
  skip = NULL,
  verbose = TRUE
)
}
\arguments{
\item{path}{Path to the Excel file}

\item{type}{Character string: one of \code{"enrolled"} or \code{"clients"}}

\item{snapshot_date}{Date of the administrative snapshot}

\item{sheet}{Sheet name or index to read (NULL for the first sheet)}

\item{skip}{Number of header rows to skip. If NULL, auto-detected:
\code{"enrolled"} tries skip = 0 first (current format), falls back to
skip = 2 (legacy); \code{"clients"} always skip = 2.}

\item{verbose}{Logical; print progress messages? Default TRUE.}
}
\value{
An \code{alccdf_subsidy_raw} S3 object
}
\description{
Reads a DHR subsidy Excel file (Enrolled Children or Active Clients With
Addresses), automatically detects the format version (legacy vs. current for
enrolled data), applies the appropriate column mapping, and returns a
standardised raw object.
}
\details{
Format detection for enrolled data:
\itemize{
\item \strong{Current (Version B)}: 20 columns with skip = 0. Contains
"Parent ID/SSN" and "Child ID/SSN" columns.
\item \strong{Legacy (Version A)}: 18 columns with skip = 2. Does NOT
contain "Parent ID/SSN" or "Child ID/SSN" columns.
}

For clients data, the format is always 14 columns with skip = 2.
}
\examples{
\dontrun{
raw <- subsidy_read(
  path = "data/ActiveEnrolledChildren_06_11_25.xlsx",
  type = "enrolled",
  snapshot_date = as.Date("2025-06-11")
)

raw_clients <- subsidy_read(
  path = "data/ActiveClientsWithAddresses_06_11_25.xlsx",
  type = "clients",
  snapshot_date = as.Date("2025-06-11")
)
}

}
